{"database":"Connected","environment":"production","level":"info","message":"üè• TSHLA Medical API Server v2.0","port":"3001","timestamp":"2025-09-04 21:47:05"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 21:47:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at WebhookProcessor.start (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:30:10)\n    at Server.<anonymous> (/Users/rakeshpatel/Desktop/tshla-medical/server/api-server-enhanced.js:602:20)\n    at Object.onceWrapper (node:events:621:28)\n    at Server.emit (node:events:519:35)\n    at emitListeningNT (node:net:1983:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:89:21)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:47:05"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 21:47:05"}
{"level":"info","message":"Database initialized successfully","timestamp":"2025-09-04 21:47:05"}
{"clientId":"anonymous","duration":"4ms","ip":"::1","level":"info","message":"API Request","method":"GET","path":"/api/health","query":{},"statusCode":200,"timestamp":"2025-09-04 21:47:18","userAgent":"curl/8.7.1"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:47:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:48:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:48:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:49:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:49:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:50:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:50:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:51:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:51:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:52:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:52:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:53:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:53:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:54:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:54:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:55:05"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:55:35"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 21:56:05"}
{"bodySize":141,"clientId":"anonymous","duration":"59ms","ip":"::1","level":"warn","message":"API Client Error","method":"POST","path":"/receive","query":{},"statusCode":401,"timestamp":"2025-09-04 21:56:11","userAgent":"curl/8.7.1"}
{"database":"Connected","environment":"production","level":"info","message":"üè• TSHLA Medical API Server v2.0","port":"3001","timestamp":"2025-09-04 21:56:42"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 21:56:42"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 21:56:42"}
{"level":"info","message":"Database initialized successfully","timestamp":"2025-09-04 21:56:42"}
{"clientId":"demo-client","level":"info","message":"Receiving note from third party","patientMRN":"TEST001","timestamp":"2025-09-04 22:00:21"}
{"bodySize":235,"clientId":"demo-client","duration":"6ms","ip":"::1","level":"info","message":"API Request","method":"POST","path":"/api/notes/receive","query":{},"statusCode":201,"timestamp":"2025-09-04 22:00:21","userAgent":"curl/8.7.1"}
{"clientId":"demo-client","duration":"1ms","ip":"::1","level":"info","message":"API Request","method":"GET","path":"/api/notes/note_1757041221767_27ae45f1","query":{},"statusCode":200,"timestamp":"2025-09-04 22:00:42","userAgent":"curl/8.7.1"}
{"bodySize":320,"clientId":"demo-client","duration":"1ms","ip":"::1","level":"info","message":"API Request","method":"POST","path":"/api/notes/batch","query":{},"statusCode":200,"timestamp":"2025-09-04 22:00:55","userAgent":"curl/8.7.1"}
{"bodySize":62,"clientId":"anonymous","duration":"30ms","ip":"::1","level":"info","message":"API Request","method":"POST","path":"/api/auth/token","query":{},"statusCode":200,"timestamp":"2025-09-04 22:01:17","userAgent":"curl/8.7.1"}
{"clientId":"demo-client","duration":"1ms","ip":"::1","level":"info","message":"API Request","method":"GET","path":"/api/notes/patient/MRN001","query":{},"statusCode":200,"timestamp":"2025-09-04 22:01:26","userAgent":"curl/8.7.1"}
{"bodySize":134,"clientId":"demo-client","duration":"0ms","ip":"::1","level":"info","message":"API Request","method":"POST","path":"/api/notes/share","query":{},"statusCode":200,"timestamp":"2025-09-04 22:01:52","userAgent":"curl/8.7.1"}
{"clientId":"anonymous","duration":"1ms","ip":"::1","level":"info","message":"API Request","method":"GET","path":"/api/shared/cd14ba4f1e90e21c04e9339a88bfeb6ca56dcbd52bccbed43e040ef63680c841","query":{},"statusCode":200,"timestamp":"2025-09-04 22:01:56","userAgent":"curl/8.7.1"}
{"database":"Connected","environment":"production","level":"info","message":"üè• TSHLA Medical API Server v2.0","port":"3001","timestamp":"2025-09-04 22:50:21"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 22:50:21"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 22:50:21"}
{"level":"info","message":"Database initialized successfully","timestamp":"2025-09-04 22:50:21"}
{"database":"Connected","environment":"production","level":"info","message":"üè• TSHLA Medical API Server v2.0","port":"3001","timestamp":"2025-09-04 23:17:59"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:17:59"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at WebhookProcessor.start (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:30:10)\n    at Server.<anonymous> (/Users/rakeshpatel/Desktop/tshla-medical/server/api-server-enhanced.js:602:20)\n    at Object.onceWrapper (node:events:621:28)\n    at Server.emit (node:events:519:35)\n    at emitListeningNT (node:net:1983:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:89:21)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 23:17:59"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:17:59"}
{"level":"info","message":"Database initialized successfully","timestamp":"2025-09-04 23:17:59"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 23:18:29"}
{"bodySize":75,"clientId":"anonymous","duration":"116ms","ip":"::1","level":"warn","message":"API Client Error","method":"POST","path":"/receive","query":{},"statusCode":401,"timestamp":"2025-09-04 23:18:54","userAgent":"curl/8.7.1"}
{"error":{"message":"db.getPendingWebhooks is not a function","name":"TypeError","stack":"TypeError: db.getPendingWebhooks is not a function\n    at WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:33)\n    at Timeout._onTimeout (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:25:14)\n    at listOnTimeout (node:internal/timers:608:17)\n    at process.processTimers (node:internal/timers:543:7)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 23:18:59"}
{"database":"Connected","environment":"production","level":"info","message":"üè• TSHLA Medical API Server v2.0","port":"3001","timestamp":"2025-09-04 23:19:10"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:19:10"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:19:10"}
{"level":"info","message":"Database initialized successfully","timestamp":"2025-09-04 23:19:11"}
{"error":{"message":"Table 'tshla_medical.webhook_events' doesn't exist","name":"Error","stack":"Error: Table 'tshla_medical.webhook_events' doesn't exist\n    at PromisePoolConnection.query (/Users/rakeshpatel/Desktop/tshla-medical/server/node_modules/mysql2/lib/promise/connection.js:29:22)\n    at MySQLDatabaseService.getPendingWebhooks (/Users/rakeshpatel/Desktop/tshla-medical/server/database/db-mysql.js:440:43)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:24)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 23:19:11"}
{"error":{"message":"Table 'tshla_medical.webhook_events' doesn't exist","name":"Error","stack":"Error: Table 'tshla_medical.webhook_events' doesn't exist\n    at PromisePoolConnection.query (/Users/rakeshpatel/Desktop/tshla-medical/server/node_modules/mysql2/lib/promise/connection.js:29:22)\n    at MySQLDatabaseService.getPendingWebhooks (/Users/rakeshpatel/Desktop/tshla-medical/server/database/db-mysql.js:440:43)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:24)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 23:19:40"}
{"error":{"message":"Table 'tshla_medical.webhook_events' doesn't exist","name":"Error","stack":"Error: Table 'tshla_medical.webhook_events' doesn't exist\n    at PromisePoolConnection.query (/Users/rakeshpatel/Desktop/tshla-medical/server/node_modules/mysql2/lib/promise/connection.js:29:22)\n    at MySQLDatabaseService.getPendingWebhooks (/Users/rakeshpatel/Desktop/tshla-medical/server/database/db-mysql.js:440:43)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async WebhookProcessor.processQueue (/Users/rakeshpatel/Desktop/tshla-medical/server/webhook-processor.js:38:24)"},"level":"error","message":"Error processing webhook queue","timestamp":"2025-09-04 23:20:10"}
{"bodySize":214,"clientId":"anonymous","duration":"120ms","ip":"::1","level":"error","message":"API Error","method":"POST","path":"/receive","query":{},"statusCode":500,"timestamp":"2025-09-04 23:22:04","userAgent":"curl/8.7.1"}
{"bodySize":222,"clientId":"anonymous","duration":"106ms","ip":"::1","level":"error","message":"API Error","method":"POST","path":"/receive","query":{},"statusCode":500,"timestamp":"2025-09-04 23:34:04","userAgent":"curl/8.7.1"}
{"database":"Connected","environment":"production","level":"info","message":"üè• TSHLA Medical API Server v2.0","port":"3001","timestamp":"2025-09-04 23:34:15"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:34:15"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:34:15"}
{"level":"info","message":"Database initialized successfully","timestamp":"2025-09-04 23:34:15"}
{"bodySize":176,"clientId":"anonymous","duration":"102ms","ip":"::1","level":"error","message":"API Error","method":"POST","path":"/receive","query":{},"statusCode":500,"timestamp":"2025-09-04 23:35:17","userAgent":"curl/8.7.1"}
{"database":"Connected","environment":"production","level":"info","message":"üè• TSHLA Medical API Server v2.0","port":"3001","timestamp":"2025-09-04 23:36:06"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:36:06"}
{"level":"info","message":"Webhook processor started","timestamp":"2025-09-04 23:36:06"}
{"level":"info","message":"Database initialized successfully","timestamp":"2025-09-04 23:36:06"}
{"clientId":"demo-client","level":"info","message":"Receiving note from third party","patientMRN":"AWS_RDS_001","timestamp":"2025-09-04 23:36:24"}
{"bodySize":193,"clientId":"demo-client","duration":"359ms","ip":"::1","level":"info","message":"API Request","method":"POST","path":"/api/notes/receive","query":{},"statusCode":201,"timestamp":"2025-09-04 23:36:24","userAgent":"curl/8.7.1"}
