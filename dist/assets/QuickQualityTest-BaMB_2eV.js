import{b as c,l as p,r as g,j as s}from"./index-CFDQeSWK.js";import{a as N,m as h}from"./awsTranscribeSimple.service-DgqysyDz.js";import"./resolveDefaultsModeConfig-R7vZuTP0.js";class C{corrections=new Map([[/\bfenergan\b/gi,"Phenergan"],[/\bphenergan\b/gi,"Phenergan"],[/\bzofran\b/gi,"Zofran"],[/\bfarxiga\b/gi,"Farxiga"],[/\blantus\b/gi,"Lantus"],[/\bnovolog\b/gi,"Novolog"],[/\boverlock\b/gi,"Novolog"],[/\bnovo\s*log\b/gi,"Novolog"],[/\bmetformin\b/gi,"Metformin"],[/\blisinopril\b/gi,"Lisinopril"],[/\batorvastatin\b/gi,"Atorvastatin"],[/\bsimvastatin\b/gi,"Simvastatin"],[/\bgabapentin\b/gi,"Gabapentin"],[/\bomeprazole\b/gi,"Omeprazole"],[/\bamlodipine\b/gi,"Amlodipine"],[/\bmetoprolol\b/gi,"Metoprolol"],[/\blosartan\b/gi,"Losartan"],[/\bhydrochlorothiazide\b/gi,"Hydrochlorothiazide"],[/\bhctz\b/gi,"HCTZ"],[/\bdiabetes mellitus\b/gi,"Diabetes Mellitus"],[/\bhypertension\b/gi,"Hypertension"],[/\bhyperlipidemia\b/gi,"Hyperlipidemia"],[/\bgerd\b/gi,"GERD"],[/\bcopd\b/gi,"COPD"],[/\bchf\b/gi,"CHF"],[/\bcad\b/gi,"CAD"],[/\bafib\b/gi,"AFib"],[/\ba fib\b/gi,"AFib"],[/\batrial fibrillation\b/gi,"Atrial Fibrillation"],[/\ba1c\b/gi,"A1C"],[/\bhemoglobin a1c\b/gi,"Hemoglobin A1C"],[/\bcmp\b/gi,"CMP"],[/\bcbc\b/gi,"CBC"],[/\btsh\b/gi,"TSH"],[/\bbmp\b/gi,"BMP"],[/\bldl\b/gi,"LDL"],[/\bhdl\b/gi,"HDL"],[/\begfr\b/gi,"eGFR"],[/\bbun\b/gi,"BUN"],[/\bast\b/gi,"AST"],[/\balt\b/gi,"ALT"],[/\bmilligrams?\b/gi,"mg"],[/\bunits?\s+(?=\d)/gi,"units "],[/\b(\d+)\s*mgs?\b/gi,"$1 mg"],[/\b(\d+)\s*mls?\b/gi,"$1 mL"],[/\bemail\s+(?=insulin|meal)/gi,"meal"],[/\bwith\s+email\b/gi,"with meal"],[/\bat\s+email\b/gi,"at meal"],[/\beach\s+email\b/gi,"each meal"],[/\bsugar\s+3\s+picture\b/gi,"sugar 300"],[/\bsugar\s+4\s+picture\b/gi,"sugar 400"],[/\bthey're like in the (\d+) and (\d+)s?\b/gi,"blood sugars $1-$2"],[/\babdomen\b/gi,"abdomen"],[/\bthorax\b/gi,"thorax"],[/\bextremities\b/gi,"extremities"],[/\bbilateral\b/gi,"bilateral"],[/\banterior\b/gi,"anterior"],[/\bposterior\b/gi,"posterior"],[/\blateral\b/gi,"lateral"],[/\bmedial\b/gi,"medial"],[/\bblood pressure\b/gi,"blood pressure"],[/\bheart rate\b/gi,"heart rate"],[/\brespiratory rate\b/gi,"respiratory rate"],[/\btemperature\b/gi,"temperature"],[/\boxygen saturation\b/gi,"oxygen saturation"],[/\bO2 sat\b/gi,"O2 sat"],[/\bpatient presents with\b/gi,"patient presents with"],[/\bchief complaint\b/gi,"chief complaint"],[/\bhistory of present illness\b/gi,"history of present illness"],[/\breview of systems\b/gi,"review of systems"],[/\bphysical exam\b/gi,"physical exam"],[/\bno acute distress\b/gi,"no acute distress"],[/\bwithin normal limits\b/gi,"within normal limits"],[/\bfollow up\b/gi,"follow-up"],[/\bas needed\b/gi,"as needed"],[/\bprn\b/gi,"PRN"],[/\btid\b/gi,"TID"],[/\bbid\b/gi,"BID"],[/\bqd\b/gi,"QD"],[/\bqid\b/gi,"QID"],[/\bpo\b/gi,"PO"],[/\bim\b/gi,"IM"],[/\biv\b/gi,"IV"],[/\bsubq\b/gi,"SubQ"]]);enhanceTranscript(e){if(!e)return"";let i=e;return this.corrections.forEach((r,n)=>{i=i.replace(n,r)}),i=this.fixMedicalNumbers(i),i=this.fixDosagePatterns(i),i=this.cleanupSpacing(i),i}fixMedicalNumbers(e){return e=e.replace(/\bsugar\s+(\d)\s*(?:\s|$|,|\.|;)/gi,(i,r)=>parseInt(r)<=9?`sugar ${r}00 `:i),e=e.replace(/\b(\d{2,3})\s+over\s+(\d{2,3})\b/gi,"$1/$2"),e=e.replace(/\bin\s+the\s+(\d+)s\b/gi,"in the $1s"),e}fixDosagePatterns(e){return e=e.replace(/(\d+)\s*units?\s+(?:with\s+)?(?:each\s+)?(?:email|mill)\b/gi,"$1 units with each meal"),e=e.replace(/increase\s+to\s+(\d+)\s*units?\b/gi,"increase to $1 units"),e=e.replace(/(\d+)\s*(?:mg|milligrams?)\s+daily\b/gi,"$1 mg daily"),e=e.replace(/(\d+)\s*(?:mg|milligrams?)\s+twice\s+daily\b/gi,"$1 mg twice daily"),e}cleanupSpacing(e){return e=e.replace(/\s+/g," "),e=e.replace(/\s+([.,;!?])/g,"$1"),e=e.replace(/([.,;!?])(?=[A-Z])/g,"$1 "),e=e.replace(/\.(?=[A-Z])/g,". "),e.trim()}detectSpecialty(e){const i=e.toLowerCase();return i.includes("diabetes")||i.includes("insulin")||i.includes("a1c")||i.includes("glucose")?"Endocrinology":i.includes("chest pain")||i.includes("cardiac")||i.includes("heart")||i.includes("ekg")?"Cardiology":i.includes("depression")||i.includes("anxiety")||i.includes("psychiatric")||i.includes("mental health")?"Psychiatry":i.includes("joint")||i.includes("arthritis")||i.includes("fracture")||i.includes("orthopedic")?"Orthopedics":i.includes("headache")||i.includes("seizure")||i.includes("neurological")||i.includes("nerve")?"Neurology":i.includes("rash")||i.includes("skin")||i.includes("dermatitis")||i.includes("lesion")?"Dermatology":i.includes("pregnant")||i.includes("prenatal")||i.includes("obstetric")||i.includes("gynecologic")?"OB/GYN":i.includes("pediatric")||i.includes("child")||i.includes("infant")||i.includes("vaccination")?"Pediatrics":"Primary Care"}addMedicalContext(e,i){let r=e;if(i?.diagnoses){const n=i.diagnoses.toLowerCase();n.includes("diabetes")&&(r=r.replace(/\bsugar\b/gi,"blood sugar").replace(/\binsulin\s+pump\b/gi,"insulin pump").replace(/\bcgm\b/gi,"CGM")),n.includes("hypertension")&&(r=r.replace(/\bpressure\b/gi,"blood pressure").replace(/\bace\b/gi,"ACE"))}return r}}const j=new C;class R{recognition=null;isListening=!1;onTranscriptUpdate;onError;onStatusChange;constructor(){this.initializeRecognition()}initializeRecognition(){if(typeof window>"u")return;const e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e){c("dictation","Error message",{});return}try{this.recognition=new e,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.maxAlternatives=1,p("dictation","Debug message",{}),this.setupEventHandlers()}catch{c("dictation","Error message",{}),this.recognition=null}}setupEventHandlers(){this.recognition&&(this.recognition.onstart=()=>{this.isListening=!0,this.onStatusChange?.("listening")},this.recognition.onresult=e=>{let i="",r="";for(let n=e.resultIndex;n<e.results.length;n++){const l=e.results[n][0].transcript;e.results[n].isFinal?i+=l+" ":r+=l}if(i){const n=j.enhanceTranscript(i);this.onTranscriptUpdate?.(n,!0)}if(r){const n=j.enhanceTranscript(r);this.onTranscriptUpdate?.(n,!1)}},this.recognition.onerror=e=>{if(!(e.error==="aborted"||e.error==="no-speech")){if(c("dictation","Error message",{}),e.error==="not-allowed"){this.onError?.("Microphone access denied. Please check your browser settings and allow microphone access for this site."),this.stop();return}if(e.error==="network"){this.onError?.("Network error. Please check your internet connection."),this.stop();return}if(e.error==="audio-capture"){this.onError?.("Microphone not found or not working. Please check your microphone connection."),this.stop();return}e.error!=="aborted"&&this.isListening&&(p("dictation","Debug message",{}),setTimeout(()=>this.restart(),500))}},this.recognition.onend=()=>{this.isListening?setTimeout(()=>this.restart(),100):this.onStatusChange?.("idle")})}start(e,i,r){if(!this.recognition)return i?.("Speech recognition not available"),!1;this.onTranscriptUpdate=e,this.onError=i,this.onStatusChange=r;try{return this.recognition.start(),this.isListening=!0,!0}catch{return c("dictation","Error message",{}),!1}}stop(){if(this.isListening=!1,this.recognition)try{this.recognition.stop()}catch{c("dictation","Error message",{})}this.onStatusChange?.("idle")}restart(){if(!(!this.isListening||!this.recognition))try{this.recognition.start()}catch{p("dictation","Debug message",{})}}isSupported(){if(typeof window>"u")return!1;const e=!!window.SpeechRecognition||!!window.webkitSpeechRecognition;return e&&!this.recognition&&this.initializeRecognition(),e&&this.recognition!==null}}const v=new R;function P(){const[o,e]=g.useState(!1),[i,r]=g.useState(""),[n,l]=g.useState(""),[u,x]=g.useState("aws"),[d,f]=g.useState(0),S=["Patient has hypertension, takes lisinopril twenty milligrams daily","Blood pressure today is one forty two over eighty eight","Started metformin one thousand milligrams twice a day for diabetes","Follow up in three months with repeat A one C","Physical exam shows lungs clear to auscultation bilaterally"],T=async()=>{e(!0),r(""),l(""),u==="aws"?await N.startRecording((t,m)=>{if(m){const y=t.replace(/\bmg\b/g," milligrams").replace(/\bBID\b/g,"twice a day");r(w=>w+" "+y),l(w=>w+" "+t);const b=h.getMedicalTermDensity(t);f(b*100)}},t=>{c("QuickQualityTest","Error message",{}),alert(`Error: ${t}`),e(!1)})||e(!1):v.start((a,t)=>{if(t){r(b=>b+" "+a);const m=h.enhanceTranscript(a);l(b=>b+" "+m);const y=h.getMedicalTermDensity(m);f(y*100)}},a=>{c("QuickQualityTest","Error message",{}),alert(`Error: ${a}`),e(!1)})},D=()=>{u==="aws"?(N.stopRecording(),p("QuickQualityTest","Debug message",{})):v.stop(),e(!1)},E=()=>{const a=h.enhanceTranscript(i);l(a);const t=h.getMedicalTermDensity(a);f(t*100)};return s.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[s.jsx("h1",{className:"text-3xl font-bold mb-6",children:"üéØ Quick Quality Test"}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[s.jsx("h2",{className:"font-semibold mb-3",children:"Select Transcription Mode:"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("button",{onClick:()=>x("aws"),className:`px-4 py-2 rounded ${u==="aws"?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300"}`,children:"AWS Transcribe Medical (HIPAA)"}),s.jsx("button",{onClick:()=>x("browser"),className:`px-4 py-2 rounded ${u==="browser"?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300"}`,children:"Browser Speech API"})]})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"üìã Test These Phrases:"}),s.jsx("ol",{className:"list-decimal ml-6 space-y-1",children:S.map((a,t)=>s.jsx("li",{className:"text-sm",children:a},t))})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[s.jsxs("div",{className:"flex gap-4 mb-4",children:[s.jsx("button",{onClick:o?D:T,className:`px-6 py-3 rounded-lg font-semibold ${o?"bg-red-600 hover:bg-red-700 text-white":"bg-green-600 hover:bg-green-700 text-white"}`,children:o?"‚èπ Stop Recording":"üé§ Start Recording"}),!o&&i&&s.jsx("button",{onClick:E,className:"px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold",children:"‚ú® Re-Apply Enhancement"})]}),o&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"animate-pulse bg-red-500 h-3 w-3 rounded-full"}),s.jsx("span",{className:"text-sm text-gray-600",children:"Recording... Speak clearly"})]})]}),d>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Quality Score:"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-4",children:s.jsx("div",{className:`h-4 rounded-full ${d>15?"bg-green-500":d>10?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(d*5,100)}%`}})}),s.jsxs("span",{className:"font-bold",children:[d.toFixed(1),"%"]})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Medical term density (higher is better, 15%+ is excellent)"})]}),(i||n)&&s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2 text-red-700",children:"‚ùå Before Enhancement (Raw)"}),s.jsx("div",{className:"bg-white rounded p-3 min-h-[200px]",children:s.jsx("p",{className:"whitespace-pre-wrap text-sm",children:i||"Waiting for transcription..."})})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold mb-2 text-green-700",children:"‚úÖ After Enhancement (Fixed)"}),s.jsx("div",{className:"bg-white rounded p-3 min-h-[200px]",children:s.jsx("p",{className:"whitespace-pre-wrap text-sm",children:n||"Waiting for transcription..."})})]})]}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"üîß What We Fixed:"}),s.jsxs("ul",{className:"text-sm space-y-1",children:[s.jsx("li",{children:"‚úÖ AWS Transcribe set to DICTATION mode (not conversation)"}),s.jsx("li",{children:"‚úÖ Disabled echo cancellation (was removing medical 's' sounds)"}),s.jsx("li",{children:"‚úÖ Medical vocabulary enhancement (metformin, lisinopril, etc.)"}),s.jsx("li",{children:'‚úÖ Proper formatting (142/88 instead of "142 over 88")'}),s.jsx("li",{children:"‚úÖ Medical abbreviations (BID, TID, PRN)"}),s.jsx("li",{children:'‚úÖ Dosage formatting (20mg instead of "20 milligrams")'})]})]})]})}export{P as default};
//# sourceMappingURL=QuickQualityTest-BaMB_2eV.js.map
