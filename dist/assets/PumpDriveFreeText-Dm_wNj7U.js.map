{"version":3,"file":"PumpDriveFreeText-Dm_wNj7U.js","sources":["../../src/pages/PumpDriveFreeText.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { freeTextMCPService } from '../services/freeTextMCP.service';\n\ninterface FreeTextData {\n  currentSituation: string;\n  timestamp: string;\n}\n\nconst PumpDriveFreeText: React.FC = () => {\n  const navigate = useNavigate();\n  const [freeText, setFreeText] = useState('');\n  const [isSaving, setIsSaving] = useState(false);\n  const [charCount, setCharCount] = useState(0);\n\n  const handleTextChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const text = e.target.value;\n    setFreeText(text);\n    setCharCount(text.length);\n  };\n\n  const handleSubmit = async () => {\n    if (!freeText.trim()) {\n      alert('Please share your thoughts before continuing.');\n      return;\n    }\n\n    setIsSaving(true);\n    \n    try {\n      // Generate session ID\n      const sessionId = freeTextMCPService.generateSessionId();\n      \n      // Analyze the text\n      const analysis = freeTextMCPService.analyzeText(freeText);\n      \n      // Save to MCP server\n      await freeTextMCPService.saveFreeTextResponse(sessionId, freeText.trim(), analysis);\n      \n      // Save to session storage for backward compatibility\n      const freeTextData: FreeTextData = {\n        currentSituation: freeText.trim(),\n        timestamp: new Date().toISOString()\n      };\n      \n      sessionStorage.setItem('pumpDriveFreeText', JSON.stringify(freeTextData));\n      sessionStorage.setItem('freeTextSessionId', sessionId);\n      \n      console.log('‚úÖ Free text saved successfully');\n      \n      // Navigate to next step\n      navigate('/pumpdrive/results');\n      \n    } catch (error) {\n      console.error('‚ùå Error saving free text:', error);\n      alert('Error saving your response. Please try again.');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleSkip = () => {\n    // Save empty response but still track that user was here\n    const freeTextData: FreeTextData = {\n      currentSituation: '',\n      timestamp: new Date().toISOString()\n    };\n    sessionStorage.setItem('pumpDriveFreeText', JSON.stringify(freeTextData));\n    navigate('/pumpdrive/results');\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 p-4\">\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <h1 className=\"text-4xl font-bold text-gray-800 mb-4\">\n            üí≠ Share Your Story\n          </h1>\n          <p className=\"text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed\">\n            Tell us what you like or don't like about your current situation and any fears or excitement about going on a new pump\n          </p>\n          <div className=\"w-24 h-1 bg-purple-500 mx-auto mt-4 rounded\"></div>\n        </div>\n\n        {/* Main Content */}\n        <div className=\"bg-white rounded-2xl p-8 shadow-lg border border-gray-100 mb-8\">\n          {/* Prompt */}\n          <div className=\"mb-6\">\n            <h2 className=\"text-2xl font-semibold text-gray-800 mb-4 flex items-center\">\n              <span className=\"text-3xl mr-3\">üó£Ô∏è</span>\n              Your Current Experience\n            </h2>\n            <div className=\"bg-purple-50 p-6 rounded-lg border-l-4 border-purple-400\">\n              <p className=\"text-gray-700 leading-relaxed mb-4\">\n                <strong>We'd love to hear from you:</strong>\n              </p>\n              <ul className=\"space-y-2 text-gray-700\">\n                <li>‚Ä¢ What do you like or dislike about your current diabetes management?</li>\n                <li>‚Ä¢ What concerns or fears do you have about switching to a new pump?</li>\n                <li>‚Ä¢ What are you most excited about with a potential new pump?</li>\n                <li>‚Ä¢ Any specific challenges or goals you'd like to address?</li>\n              </ul>\n            </div>\n          </div>\n\n          {/* Text Area */}\n          <div className=\"mb-6\">\n            <label htmlFor=\"freeText\" className=\"block text-sm font-medium text-gray-700 mb-3\">\n              Share your thoughts (optional but helpful for better recommendations):\n            </label>\n            <textarea\n              id=\"freeText\"\n              value={freeText}\n              onChange={handleTextChange}\n              placeholder=\"Take your time and share whatever feels important to you. There are no right or wrong answers - we just want to understand your unique situation better...\"\n              className=\"w-full h-64 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none text-gray-700 leading-relaxed\"\n              maxLength={2000}\n            />\n            \n            {/* Character Counter */}\n            <div className=\"flex justify-between mt-2 text-sm\">\n              <span className=\"text-gray-500\">\n                {charCount === 0 ? 'Feel free to write as much or as little as you\\'d like' : 'Thank you for sharing your thoughts'}\n              </span>\n              <span className={`${charCount > 1800 ? 'text-orange-500' : 'text-gray-400'}`}>\n                {charCount}/2000 characters\n              </span>\n            </div>\n          </div>\n\n          {/* Benefits of Sharing */}\n          <div className=\"bg-green-50 p-4 rounded-lg border border-green-200 mb-6\">\n            <h3 className=\"text-sm font-semibold text-green-800 mb-2\">üí° Why this helps:</h3>\n            <div className=\"text-sm text-green-700 space-y-1\">\n              <p>‚Ä¢ More personalized pump recommendations</p>\n              <p>‚Ä¢ Better understanding of your specific needs and concerns</p>\n              <p>‚Ä¢ Tailored advice for your transition process</p>\n            </div>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n            <button\n              onClick={handleSkip}\n              className=\"px-8 py-3 rounded-xl text-lg font-semibold bg-gray-200 text-gray-700 hover:bg-gray-300 transition-all\"\n            >\n              ‚è≠Ô∏è Skip for Now\n            </button>\n            \n            <button\n              onClick={handleSubmit}\n              disabled={isSaving}\n              className={`px-8 py-3 rounded-xl text-lg font-semibold transition-all transform ${\n                isSaving\n                  ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\n                  : 'bg-purple-600 text-white hover:bg-purple-700 hover:scale-105 shadow-lg'\n              }`}\n            >\n              {isSaving ? (\n                <span className=\"flex items-center justify-center\">\n                  <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" fill=\"none\" viewBox=\"0 0 24 24\">\n                    <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                    <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                  </svg>\n                  üíæ Saving...\n                </span>\n              ) : (\n                'üéØ Continue to Recommendations'\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Progress Indicator */}\n        <div className=\"text-center\">\n          <div className=\"text-sm text-gray-500\">\n            Step 2 of 3: Personal Story\n          </div>\n          <div className=\"w-full bg-gray-200 rounded-full h-2 mt-2 max-w-md mx-auto\">\n            <div className=\"bg-purple-600 h-2 rounded-full\" style={{ width: '67%' }}></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PumpDriveFreeText;"],"names":["PumpDriveFreeText","navigate","useNavigate","freeText","setFreeText","useState","isSaving","setIsSaving","charCount","setCharCount","handleTextChange","e","text","handleSubmit","sessionId","freeTextMCPService","analysis","freeTextData","error","handleSkip","jsxs","jsx"],"mappings":"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"}