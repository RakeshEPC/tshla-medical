import{c as m,u as ce,r as a,e as P,b as d,j as e,l as f,g as G}from"./index-JAW6HvUl.js";import{m as Y}from"./medicalCorrections.service-DDTgANcC.js";import{d as k}from"./doctorProfile.service-D2iM7g3D.js";import{A as de}from"./arrow-left-BosNFyyn.js";import{S as me}from"./star-IARMEOCM.js";import{U as xe}from"./user-NxtgiHxX.js";import{P as ue}from"./play-BQ0jfMXR.js";import{F as A}from"./file-text-4DKCZsvQ.js";import{C as he}from"./chevron-down-CkM-qfmA.js";import{C as pe}from"./copy-OgEbAmiN.js";import{D as ge}from"./download-DxAqtIil.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Z=m("brain",fe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Ne=m("heart",be);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],J=m("mic",ve);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],K=m("sparkles",je);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],we=m("square",ye);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Se=m("zap",ke);function ze(){const Q=ce(),[n,S]=a.useState(!1),[i,C]=a.useState(""),[x,b]=a.useState(""),[Ce,_]=a.useState(""),[u,M]=a.useState(""),[c,F]=a.useState(!1),[z,T]=a.useState(!1),[h,N]=a.useState(!1),[U,v]=a.useState(""),[$,q]=a.useState("dictation"),[p,E]=a.useState(null),[X,ee]=a.useState([]),[I,R]=a.useState(!1),[te,se]=a.useState(null),[l,j]=a.useState({name:"",mrn:"",dob:"",email:"",visitDate:new Date().toLocaleDateString()}),[ae,L]=a.useState(0),[O,D]=a.useState(0),g=a.useRef(null);a.useEffect(()=>{const t=P.getCurrentUser();se(t),re()},[]),a.useEffect(()=>{const t=i.trim().split(/\s+/).filter(s=>s.length>0);L(t.length)},[i]),a.useEffect(()=>(n?(D(0),g.current=setInterval(()=>{D(t=>t+1)},1e3)):g.current&&clearInterval(g.current),()=>{g.current&&clearInterval(g.current)}),[n]);const re=async()=>{try{const t=P.getCurrentUser(),s=t?.id||t?.email||"doctor-default-001";k.initialize(s);const r=await k.getTemplates(s);ee(r);const o=await k.getDefaultTemplate(s);o&&E(o)}catch{d("QuickNoteModern","Error message",{})}},W=t=>{const s=Math.floor(t/60),r=t%60;return`${s}:${r.toString().padStart(2,"0")}`},le=async()=>{if(!n)try{f("QuickNoteModern","Debug message",{}),f("QuickNoteModern","Debug message",{}),await azureSpeechTranscription.startRecording((s,r)=>{const o=Y.correctTranscription(s);r?(C(y=>y+(y?" ":"")+o),b("")):b(o)},s=>{d("QuickNoteModern","Error message",{}),v(`Error: ${s}`),S(!1)})?(S(!0),v("")):v("Failed to start recording")}catch{d("QuickNoteModern","Error message",{}),v("Failed to start recording. Please try again.")}},oe=async()=>{if(n){S(!1);try{azureSpeechTranscription.stopRecording();let t=i;if(x.trim()){const s=Y.correctTranscription(x);t=i+(i?" ":"")+s,C(t),b("")}t.trim()&&setTimeout(()=>{B(t)},500)}catch{d("QuickNoteModern","Error message",{})}}},B=async t=>{const s=t||i;if(!s.trim()){alert("Please record some content first");return}F(!0),T(!1);try{const r=`
PATIENT INFORMATION:
Name: ${l.name||"[Not provided]"}
MRN: ${l.mrn||"[Not provided]"}
DOB: ${l.dob||"[Not provided]"}
Email: ${l.email||"[Not provided]"}
Visit Date: ${l.visitDate}
      `.trim(),o=$==="conversation"?`CONVERSATION TRANSCRIPT:
${s}`:s,y={id:"quick-note-modern",name:l.name||"Unknown Patient",mrn:l.mrn||"Unknown MRN",dob:l.dob||"",email:l.email||"",diagnosis:[],medications:[],labResults:[],vitalSigns:{bp:"",hr:"",temp:"",weight:"",bmi:""}};let w;if(f("QuickNoteModern","Debug message",{}),p){G("QuickNoteModern","Info message",{});try{const H=await k.getSettings();w={template:p,doctorSettings:H},G("QuickNoteModern","Info message",{})}catch{w={template:p,doctorSettings:null},f("QuickNoteModern","Debug message",{})}}else f("QuickNoteModern","Debug message",{});const V=(await azureAIService.processMedicalTranscription(o,y,null,`Patient context: ${r}`,w)).formatted;_(V),M(V),T(!0)}catch(r){d("QuickNoteModern","Error message",{});const o=r instanceof Error?r.message:"Unknown error";alert(`Failed to process with AI: ${o}`)}finally{F(!1)}},ne=async t=>{try{const s=t||u;await navigator.clipboard.writeText(s.replace(/###\s*/g,"").replace(/\*\*(.*?)\*\*/g,"$1"));const r=document.createElement("div");r.className="fixed top-4 right-4 bg-green-600 text-white px-4 py-3 rounded-lg shadow-lg z-50 notification-calm",r.innerHTML="✓ Copied to clipboard",document.body.appendChild(r),setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},2e3)}catch{d("QuickNoteModern","Error message",{}),alert("Failed to copy to clipboard")}},ie=()=>{C(""),b(""),_(""),M(""),T(!1),N(!1),L(0),D(0)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none opacity-30",children:[e.jsx("div",{className:"absolute -top-4 -left-4 w-96 h-96 bg-blue-200 rounded-full filter blur-3xl opacity-40"}),e.jsx("div",{className:"absolute -bottom-4 -right-4 w-96 h-96 bg-indigo-200 rounded-full filter blur-3xl opacity-40"})]}),e.jsx("div",{className:"glass-card-calm mx-4 mt-4 p-4 relative z-10",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>Q("/doctor"),className:"glass-button p-2 rounded-lg hover:scale-105 transition-transform",children:e.jsx(de,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-calm-gradient flex items-center gap-2",children:[e.jsx(Se,{className:"w-6 h-6"}),"Quick Note"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome, ",te?.name||"Doctor"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"status-indicator status-ready",children:["📝 ",ae," words"]}),e.jsxs("div",{className:"status-indicator status-ready",children:["⏱️ ",W(O)]}),e.jsx("button",{onClick:()=>{P.logout(),Q("/login")},className:"btn-calm btn-calm-danger px-4 py-2 text-sm",children:"Sign Out"})]})]})}),e.jsx("div",{className:"px-4 py-6 relative z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-[400px_1fr] gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-card-calm p-6 card-hover-calm",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-yellow-500"}),"Recording Mode"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>q("dictation"),className:`p-4 rounded-xl transition-all duration-300 ${$==="dictation"?"bg-blue-600 text-white shadow-md":"bg-white border border-gray-200 text-gray-700 hover:bg-blue-50 hover:border-blue-200"}`,children:[e.jsx(J,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-semibold",children:"Dictation"}),e.jsx("div",{className:"text-xs opacity-75",children:"Single speaker"})]}),e.jsxs("button",{onClick:()=>q("conversation"),className:`p-4 rounded-xl transition-all duration-300 ${$==="conversation"?"bg-indigo-600 text-white shadow-md":"bg-white border border-gray-200 text-gray-700 hover:bg-indigo-50 hover:border-indigo-200"}`,children:[e.jsx(xe,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-sm font-semibold",children:"Conversation"}),e.jsx("div",{className:"text-xs opacity-75",children:"Multi-speaker"})]})]})]}),e.jsxs("div",{className:"glass-card-calm p-6 card-hover-calm text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-4",children:[e.jsx("button",{onClick:le,disabled:n||c,className:`w-20 h-20 rounded-full flex items-center justify-center transition-all duration-300 ${n||c?"bg-gray-300 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"} text-white`,children:e.jsx(ue,{className:"w-8 h-8 ml-1"})}),e.jsx("button",{onClick:oe,disabled:!n||c,className:`w-20 h-20 rounded-full flex items-center justify-center transition-all duration-300 ${!n||c?"bg-gray-300 cursor-not-allowed":"bg-red-600 hover:bg-red-700 shadow-lg hover:shadow-xl"} text-white`,children:e.jsx(we,{className:"w-8 h-8"})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-800",children:n?"🎙️ Recording...":"🎤 Ready to Record"}),e.jsx("div",{className:"text-sm text-gray-600",children:n?`Duration: ${W(O)}`:"Click start to begin"}),n&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsxs("div",{className:"status-indicator status-recording",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full recording-dot"}),e.jsx("span",{children:"Recording Live"})]})})]})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:()=>B(),disabled:!i.trim()||c,className:"btn-calm btn-calm-primary px-6 py-3 flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner-calm"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-5 h-5"}),"AI Process"]})}),e.jsxs("button",{onClick:ie,className:"btn-calm btn-calm-danger px-6 py-3 flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5"}),"Clear"]})]}),U&&e.jsx("div",{className:"mt-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700 text-sm animate-shake",children:U})]}),e.jsxs("div",{className:"glass-card-calm p-6 card-hover-calm",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-blue-500"}),"Template"]}),e.jsxs("button",{onClick:()=>R(!I),className:"glass-button w-full p-3 rounded-lg text-left flex items-center justify-between hover:scale-105 transition-transform",children:[e.jsx("span",{children:p?p.name:"No Template Selected"}),e.jsx(he,{className:`w-4 h-4 transition-transform ${I?"rotate-180":""}`})]}),I&&e.jsxs("div",{className:"mt-3 glass-card p-3 max-h-48 overflow-y-auto modern-scrollbar slide-in-right",children:[e.jsx("button",{onClick:()=>{E(null),R(!1)},className:"w-full p-2 text-left hover:bg-white hover:bg-opacity-50 rounded text-sm",children:"No Template (Standard SOAP)"}),X.map(t=>e.jsx("button",{onClick:()=>{E(t),R(!1)},className:"w-full p-2 text-left hover:bg-white hover:bg-opacity-50 rounded text-sm",children:t.name},t.id))]})]}),e.jsxs("div",{className:"glass-card-calm p-6 card-hover-calm",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-red-500"}),"Patient Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Patient Name"}),e.jsx("input",{type:"text",value:l.name,onChange:t=>j(s=>({...s,name:t.target.value})),className:"modern-input-calm w-full",placeholder:"Enter patient name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"MRN"}),e.jsx("input",{type:"text",value:l.mrn,onChange:t=>j(s=>({...s,mrn:t.target.value})),className:"modern-input-calm w-full",placeholder:"Medical Record Number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",value:l.dob,onChange:t=>j(s=>({...s,dob:t.target.value})),className:"modern-input-calm w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:l.email,onChange:t=>j(s=>({...s,email:t.target.value})),className:"modern-input-calm w-full",placeholder:"patient@email.com"})]})]})]}),e.jsxs("div",{className:"glass-card-calm p-6 card-hover-calm",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-green-500"}),"Live Transcript"]}),e.jsx("div",{className:"bg-white bg-opacity-80 rounded-xl p-3 min-h-48 max-h-64 overflow-y-auto calm-scrollbar",children:i||x?e.jsxs("div",{className:"text-gray-800 whitespace-pre-wrap text-sm leading-relaxed",children:[i,x&&e.jsx("span",{className:"text-blue-500 italic",children:x})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Start recording to see your transcript"})]})})})]})]}),e.jsxs("div",{className:"glass-card-calm p-6 card-hover-calm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-purple-500"}),"AI-Generated Note"]}),z&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(!h),className:`glass-button p-2 rounded-lg hover:scale-105 transition-transform ${h?"bg-blue-100":""}`,title:h?"View formatted":"Edit note",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ne(),className:"glass-button p-2 rounded-lg hover:scale-105 transition-transform",title:"Copy to clipboard",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{const t=u.replace(/###\s*/g,"").replace(/\*\*(.*?)\*\*/g,"$1"),s=window.open("","_blank");s&&(s.document.write(`
                          <html>
                            <head>
                              <title>Medical Note - ${l.name||"Patient"}</title>
                              <style>
                                body { font-family: Arial, sans-serif; padding: 20px; white-space: pre-wrap; }
                                @media print { body { padding: 10px; } }
                              </style>
                            </head>
                            <body>${t.replace(/\n/g,"<br>")}</body>
                          </html>
                        `),s.document.close(),s.print())},className:"glass-button p-2 rounded-lg hover:scale-105 transition-transform",title:"Print note",children:e.jsx(ge,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:`bg-white bg-opacity-80 rounded-xl p-4 min-h-[700px] max-h-[900px] overflow-y-auto calm-scrollbar editable-note-container ${h?"editing":""}`,children:z&&u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"edit-indicator"}),h?e.jsx("textarea",{value:u,onChange:t=>M(t.target.value),className:"note-textarea w-full h-full min-h-[650px] p-2",placeholder:"Edit your medical note here...",autoFocus:!0,onBlur:()=>N(!1)}):e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap text-sm leading-relaxed cursor-text min-h-[650px]",onClick:()=>N(!0),title:"Click to edit",children:u.split(`
`).map((t,s)=>t.startsWith("###")?e.jsx("h3",{className:"text-lg font-bold text-blue-600 mt-4 mb-2",children:t.replace("###","").trim()},s):t.includes("**")?e.jsx("p",{className:"mb-2",children:t.split("**").map((r,o)=>o%2===1?e.jsx("strong",{className:"font-semibold",children:r},o):r)},s):e.jsx("p",{className:"mb-2",children:t},s))})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg",children:"Your AI-generated note will appear here"}),e.jsx("p",{className:"text-sm mt-2",children:"Record your dictation and process with AI!"})]})})})]})]})})]})}export{ze as default};
//# sourceMappingURL=QuickNoteModern-Ck6IyiYH.js.map
