import{c as D,l as T,g as E,b as w,h as k,r as u,u as $,f as R,e as O,j as e,C as M}from"./index-JAW6HvUl.js";import{s as P}from"./scheduleDatabase.service-C2AuUFEu.js";import{C as L}from"./calendar-CAdeJ4p_.js";import{C as U}from"./chevron-down-CkM-qfmA.js";import{P as I}from"./plus-CENbmtft.js";import{F as z}from"./file-text-4DKCZsvQ.js";import{S as X,L as ee,C as te}from"./search-CExVHRss.js";import{U as _}from"./user-NxtgiHxX.js";import{S as se}from"./settings-CIWbKcWi.js";import{H as ae}from"./house-BW3MfrtO.js";import{P as F}from"./play-BQ0jfMXR.js";import{C as W,a as ne}from"./circle-check-big-DX1PZYiA.js";import{P as ie}from"./phone-KSE5FT-T.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],oe=D("bell",re);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],ce=D("calendar-days",le);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],me=D("chevron-left",de);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Y=D("circle",pe);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],ue=D("file",he);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],xe=D("grid-3x3",ge);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],ye=D("list",fe);class be{STORAGE_KEY="tshla_unified_appointments";BACKUP_KEY="tshla_unified_appointments_backup";SYNC_STATUS_KEY="tshla_appointment_sync_status";appointments=new Map;isInitialized=!1;constructor(){this.initialize()}initialize(){if(!this.isInitialized){T("unifiedAppointment","Debug message",{});try{this.loadFromStorage(),this.runLegacyMigration(),this.setupAutoSave(),this.isInitialized=!0,E("unifiedAppointment","Info message",{}),T("unifiedAppointment","Debug message",{})}catch{w("unifiedAppointment","Error message",{}),this.isInitialized=!0}}}loadFromStorage(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(t){const a=JSON.parse(t);this.appointments.clear(),a.forEach(n=>{n.createdAt=new Date(n.createdAt),n.updatedAt=new Date(n.updatedAt),this.appointments.set(n.id,n)})}}catch{k("unifiedAppointment","Warning message",{}),this.loadFromBackup()}}loadFromBackup(){try{const t=localStorage.getItem(this.BACKUP_KEY);if(t){const a=JSON.parse(t);a.appointments&&Array.isArray(a.appointments)&&(this.appointments.clear(),a.appointments.forEach(n=>{n.createdAt=new Date(n.createdAt),n.updatedAt=new Date(n.updatedAt),this.appointments.set(n.id,n)}),T("unifiedAppointment","Debug message",{}))}}catch{k("unifiedAppointment","Warning message",{})}}runLegacyMigration(){let t=0;try{const a=localStorage.getItem("tshla_simple_appointments");if(a){const o=JSON.parse(a);Array.isArray(o)&&o.forEach(m=>{const g=this.convertSimpleAppointment(m);this.appointments.has(g.id)||(this.appointments.set(g.id,g),t++)})}const n=localStorage.getItem("doctor_schedule_data");if(n){const o=JSON.parse(n);Object.keys(o).forEach(m=>{Array.isArray(o[m])&&o[m].forEach(g=>{const p=this.convertScheduleSlot(g,m);this.appointments.has(p.id)||(this.appointments.set(p.id,p),t++)})})}Object.keys(sessionStorage).forEach(o=>{if(o.startsWith("schedule_"))try{const m=o.replace("schedule_",""),g=JSON.parse(sessionStorage.getItem(o)||"[]");Array.isArray(g)&&g.forEach(p=>{const x=this.convertScheduleSlot(p,m);this.appointments.has(x.id)||(this.appointments.set(x.id,x),t++)})}catch{k("unifiedAppointment","Warning message",{})}}),t>0&&(T("unifiedAppointment","Debug message",{}),this.saveToStorage(),localStorage.setItem("tshla_legacy_migration_completed",new Date().toISOString()))}catch{w("unifiedAppointment","Error message",{})}}convertSimpleAppointment(t){return{id:t.id||this.generateId(),patientId:t.patientId||this.generatePatientId(t.patientName),patientName:t.patientName,patientPhone:t.patientPhone,patientEmail:t.patientEmail,doctorId:t.doctorId||"doctor-default",doctorName:t.doctorName||"Dr. Unknown",date:t.date,time:t.time,duration:t.duration||30,status:t.status||"scheduled",visitType:t.visitType||"follow-up",visitReason:t.visitReason||"General consultation",notes:t.notes,createdAt:t.createdAt?new Date(t.createdAt):new Date,updatedAt:new Date}}convertScheduleSlot(t,a){return{id:t.id||this.generateId(),patientId:this.generatePatientId(t.name||t.initials),patientName:t.name||t.initials||"Unknown Patient",patientPhone:void 0,patientEmail:void 0,doctorId:"doctor-default",doctorName:"Dr. Unknown",date:a,time:t.time,duration:30,status:t.status||"scheduled",visitType:"follow-up",visitReason:t.notes||"General consultation",notes:t.notes,createdAt:new Date,updatedAt:new Date}}generateId(){return`apt-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}generatePatientId(t){return`pat-${t.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}-${Date.now().toString().slice(-6)}`}saveToStorage(){try{const t=Array.from(this.appointments.values());localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t));const a={timestamp:new Date().toISOString(),version:"1.0",appointments:t};localStorage.setItem(this.BACKUP_KEY,JSON.stringify(a)),localStorage.setItem(this.SYNC_STATUS_KEY,JSON.stringify({lastSaved:new Date().toISOString(),appointmentCount:t.length}))}catch(t){throw w("unifiedAppointment","Error message",{}),t}}setupAutoSave(){setInterval(()=>{this.appointments.size>0&&this.saveToStorage()},5e3)}async createAppointment(t){const a={...t,id:this.generateId(),createdAt:new Date,updatedAt:new Date};return this.appointments.set(a.id,a),this.saveToStorage(),E("unifiedAppointment","Info message",{}),a}getAppointments(t){let a=Array.from(this.appointments.values());return t&&(t.doctorId&&t.doctorId!=="all"&&(a=a.filter(n=>n.doctorId===t.doctorId)),t.date&&(a=a.filter(n=>n.date===t.date)),t.dateRange&&(a=a.filter(n=>n.date>=t.dateRange.start&&n.date<=t.dateRange.end)),t.status&&(a=a.filter(n=>n.status===t.status))),a.sort((n,o)=>n.date!==o.date?n.date.localeCompare(o.date):this.timeToMinutes(n.time)-this.timeToMinutes(o.time))}getAppointment(t){return this.appointments.get(t)||null}async updateAppointment(t,a){const n=this.appointments.get(t);if(!n)throw new Error(`Appointment ${t} not found`);const o={...n,...a,id:n.id,updatedAt:new Date};return this.appointments.set(t,o),this.saveToStorage(),E("unifiedAppointment","Info message",{}),o}async deleteAppointment(t){return this.appointments.get(t)?(this.appointments.delete(t),this.saveToStorage(),T("unifiedAppointment","Debug message",{}),!0):!1}getAppointmentsForDate(t,a){return this.getAppointments({date:t,doctorId:a})}getStats(){const t=Array.from(this.appointments.values());return{total:t.length,scheduled:t.filter(a=>a.status==="scheduled").length,completed:t.filter(a=>a.status==="completed").length,cancelled:t.filter(a=>a.status==="cancelled").length,inProgress:t.filter(a=>a.status==="in-progress").length}}exportAppointments(){const t={exportDate:new Date().toISOString(),version:"1.0",appointments:Array.from(this.appointments.values())};return JSON.stringify(t,null,2)}clearAllAppointments(){k("unifiedAppointment","Warning message",{}),this.appointments.clear(),this.saveToStorage()}timeToMinutes(t){const[a,n]=t.split(" ");let[o,m]=a.split(":").map(Number);return n==="PM"&&o!==12&&(o+=12),n==="AM"&&o===12&&(o=0),o*60+m}}const C=new be;function Ne({providerId:i,date:t,autoRefresh:a=!0,refreshInterval:n=3e4}){const[o,m]=u.useState([]),[g,p]=u.useState(!1),[x,c]=u.useState(null),r=t.toISOString().split("T")[0],f=u.useCallback(async()=>{p(!0),c(null);try{const d=await P.getScheduleForDate(i,r);if(d.length>0){const s=d.map(l=>({id:l.id,patientId:l.id,patientName:l.name,patientPhone:l.phone,patientEmail:"",time:l.appointmentTime,date:r,visitType:"follow-up",visitReason:"",status:l.status,notes:"",providerId:i,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}));m(s)}else{const s=C.getAppointmentsForDate(r,i);m(s)}}catch(d){w("App","Error message",{}),c(d instanceof Error?d.message:"Failed to load schedule");try{const s=C.getAppointmentsForDate(r,i);m(s)}catch{w("App","Error message",{})}}finally{p(!1)}},[i,r]),b=u.useCallback(async d=>{p(!0);try{const s=await C.createAppointment({providerId:i,patientName:d.patientName||"New Patient",patientPhone:d.patientPhone,patientEmail:d.patientEmail,time:d.time||"9:00 AM",date:r,visitType:d.visitType||"follow-up",visitReason:d.visitReason||"",status:d.status||"scheduled",notes:d.notes||""});try{const l={id:s.id,name:s.patientName,mrn:s.patientId,appointmentTime:s.time,status:s.status,phone:s.patientPhone,isPlaceholder:!1};await P.saveAppointment(i,"Doctor",l,r)}catch{k("App","Warning message",{})}return!0}catch(s){return w("App","Error message",{}),c(s instanceof Error?s.message:"Failed to create appointment"),!1}finally{p(!1)}},[i,r]),y=u.useCallback(async(d,s)=>{p(!0);try{await C.updateAppointment(d,s);try{const l=o.find(j=>j.id===d);if(l){const j={id:l.patientId,name:s.patientName||l.patientName,mrn:l.patientId,appointmentTime:s.time||l.time,status:s.status||l.status,phone:s.patientPhone||l.patientPhone,isPlaceholder:!1};await P.updateAppointment(d,j)}}catch{k("App","Warning message",{})}return!0}catch(l){return w("App","Error message",{}),c(l instanceof Error?l.message:"Failed to update appointment"),!1}finally{p(!1)}},[o]),S=u.useCallback(async d=>{p(!0);try{await C.deleteAppointment(d);try{await P.deleteAppointment(d)}catch{k("App","Warning message",{})}return!0}catch(s){return w("App","Error message",{}),c(s instanceof Error?s.message:"Failed to delete appointment"),!1}finally{p(!1)}},[]),v=u.useCallback(async(d,s)=>y(d,{status:s}),[y]);return u.useEffect(()=>{f()},[i,r]),u.useEffect(()=>{if(!a)return;const d=setInterval(()=>{f()},n);return()=>clearInterval(d)},[a,n,i,r]),{appointments:o,isLoading:g,error:x,refreshSchedule:f,createAppointment:b,updateAppointment:y,deleteAppointment:S,updateAppointmentStatus:v}}function ve({currentView:i="calendar",onViewChange:t,practiceInfo:a={name:"TSHLA Medical"},showNotifications:n=!0}){const o=$(),{user:m,logout:g}=R(),[p,x]=u.useState(!1),[c,r]=u.useState(!1),f=O.getCurrentUser(),b=()=>{o("/quick-note")},y=()=>{o("/doctor/templates")},S=async()=>{try{await g(),o("/login")}catch{w("DoctorNavBar","Error message",{})}},v=[{id:"1",name:"General SOAP Note",lastUsed:"2 hours ago"},{id:"2",name:"Follow-up Visit",lastUsed:"Yesterday"},{id:"3",name:"Annual Physical",lastUsed:"3 days ago"}],d=s=>{const l="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center space-x-2";return i===s?`${l} bg-blue-500 text-white shadow-sm`:`${l} text-gray-600 hover:bg-gray-100`};return e.jsxs("nav",{className:"bg-white border-b border-gray-200 shadow-sm",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[a.logo?e.jsx("img",{src:a.logo,alt:a.name,className:"h-8 w-8 rounded"}):e.jsx("div",{className:"h-8 w-8 bg-blue-500 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"T"})}),e.jsx("span",{className:"text-xl font-semibold text-gray-900",children:a.name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>t?.("calendar"),className:d("calendar"),children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Calendar"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>r(!c),className:`${d("templates")} ${c?"bg-gray-100":""}`,children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Templates"}),e.jsx(U,{className:`w-4 h-4 transition-transform ${c?"rotate-180":""}`})]}),c&&e.jsx("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Templates"}),e.jsx("button",{onClick:()=>{y(),r(!1)},className:"text-blue-500 hover:text-blue-600 text-sm",children:"View All"})]}),e.jsx("div",{className:"space-y-1 mb-3",children:e.jsxs("button",{onClick:()=>{r(!1)},className:"w-full flex items-center space-x-2 p-2 rounded hover:bg-gray-50 text-left",children:[e.jsx(I,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:"Create New Template"})]})}),e.jsxs("div",{className:"border-t border-gray-100 pt-3",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Recent Templates"}),e.jsx("div",{className:"space-y-1",children:v.map(s=>e.jsxs("button",{onClick:()=>{r(!1)},className:"w-full text-left p-2 rounded hover:bg-gray-50",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Used ",s.lastUsed]})]},s.id))})]})]})})]}),e.jsxs("button",{onClick:()=>t?.("notes"),className:d("notes"),children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"Notes"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:b,className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 shadow-sm",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"Quick Note"})]}),e.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(X,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[n&&e.jsxs("button",{className:"relative p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx(oe,{className:"w-5 h-5 text-gray-500"}),e.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-red-500 rounded-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>x(!p),className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-8 w-8 bg-gray-300 rounded-full flex items-center justify-center",children:e.jsx(_,{className:"w-4 h-4 text-gray-600"})}),e.jsxs("div",{className:"text-left hidden sm:block",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f?.name||m?.email||"Doctor"}),e.jsx("div",{className:"text-xs text-gray-500",children:f?.specialty||"Physician"})]})]}),e.jsx(U,{className:`w-4 h-4 text-gray-500 transition-transform ${p?"rotate-180":""}`})]}),p&&e.jsx("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("button",{onClick:()=>{o("/doctor/profile"),x(!1)},className:"w-full flex items-center space-x-2 p-2 rounded hover:bg-gray-50 text-left",children:[e.jsx(_,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:"Profile"})]}),e.jsxs("button",{onClick:()=>{x(!1)},className:"w-full flex items-center space-x-2 p-2 rounded hover:bg-gray-50 text-left",children:[e.jsx(se,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:"Settings"})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("button",{onClick:()=>{S(),x(!1)},className:"w-full flex items-center space-x-2 p-2 rounded hover:bg-red-50 text-left text-red-600",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]})})]})]})]})}),(p||c)&&e.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>{x(!1),r(!1)}})]})}function je({selectedDate:i,onDateChange:t,onViewChange:a,currentView:n="day",showViewToggle:o=!0}){const[m,g]=u.useState(!1),p=()=>{const s=new Date(i);n==="day"?s.setDate(i.getDate()-1):n==="week"?s.setDate(i.getDate()-7):s.setMonth(i.getMonth()-1),t(s)},x=()=>{const s=new Date(i);n==="day"?s.setDate(i.getDate()+1):n==="week"?s.setDate(i.getDate()+7):s.setMonth(i.getMonth()+1),t(s)},c=()=>{t(new Date)},r=()=>{const s=new Date,l=new Date(s);l.setDate(s.getDate()-1);const j=new Date(s);j.setDate(s.getDate()+1);const N=new Date(s);N.setDate(s.getDate()+7);const A=new Date(s);return A.setDate(s.getDate()-7),{today:s,yesterday:l,tomorrow:j,nextWeek:N,lastWeek:A}},{today:f,yesterday:b,tomorrow:y,nextWeek:S}=r(),v=()=>{const s=i.toDateString()===f.toDateString(),l=i.toDateString()===y.toDateString(),j=i.toDateString()===b.toDateString();if(s)return"Today";if(l)return"Tomorrow";if(j)return"Yesterday";if(n==="week"){const N=new Date(i);N.setDate(i.getDate()-i.getDay());const A=new Date(N);return A.setDate(N.getDate()+6),`${N.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${A.toLocaleDateString("en-US",{month:"short",day:"numeric"})}`}return n==="month"?i.toLocaleDateString("en-US",{month:"long",year:"numeric"}):i.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})},d=i.toDateString()===f.toDateString();return e.jsxs("div",{className:"bg-white border-b border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:p,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",title:`Previous ${n}`,children:e.jsx(me,{className:"w-5 h-5"})}),e.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",title:`Next ${n}`,children:e.jsx(te,{className:"w-5 h-5"})})]}),e.jsx("button",{onClick:c,className:`px-3 py-2 rounded-lg font-medium transition-colors ${d?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200"} border`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Today"})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"w-5 h-5 text-gray-500"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:v()})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>t(b),className:"px-3 py-1 text-sm rounded-md hover:bg-gray-100 transition-colors text-gray-600",children:"Yesterday"}),e.jsx("button",{onClick:()=>t(y),className:"px-3 py-1 text-sm rounded-md hover:bg-gray-100 transition-colors text-gray-600",children:"Tomorrow"}),e.jsx("button",{onClick:()=>t(S),className:"px-3 py-1 text-sm rounded-md hover:bg-gray-100 transition-colors text-gray-600",children:"Next Week"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>g(!m),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Select specific date",children:e.jsx(ce,{className:"w-5 h-5"})}),m&&e.jsx("div",{className:"absolute top-full right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:e.jsx("input",{type:"date",value:i.toISOString().split("T")[0],onChange:s=>{t(new Date(s.target.value+"T12:00:00")),g(!1)},className:"p-3 border-none outline-none rounded-lg"})})]}),o&&a&&e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>a("day"),className:`p-2 transition-colors ${n==="day"?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,title:"Day view",children:e.jsx(M,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>a("week"),className:`p-2 transition-colors ${n==="week"?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,title:"Week view",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>a("month"),className:`p-2 transition-colors ${n==="month"?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,title:"Month view",children:e.jsx(xe,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm text-gray-500",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("span",{children:i.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{children:"15-minute slots â€¢ 9:00 AM - 5:30 PM"})})]})]})}const we=()=>{const i=[];for(let t=9;t<12;t++)i.push(`${t}:00 AM`),i.push(`${t}:15 AM`),i.push(`${t}:30 AM`),i.push(`${t}:45 AM`);i.push("12:00 PM"),i.push("12:15 PM"),i.push("12:30 PM"),i.push("12:45 PM");for(let t=1;t<=5;t++)i.push(`${t}:00 PM`),i.push(`${t}:15 PM`),i.push(`${t}:30 PM`),t<5&&i.push(`${t}:45 PM`);return i},Se=i=>{switch(i){case"completed":return e.jsx(W,{className:"w-4 h-4 text-green-500"});case"in-progress":return e.jsx(F,{className:"w-4 h-4 text-blue-500"});case"cancelled":return e.jsx(ne,{className:"w-4 h-4 text-red-500"});default:return e.jsx(Y,{className:"w-4 h-4 text-gray-400"})}},Ae=i=>{switch(i){case"completed":return"bg-green-50 border-green-200 text-green-800";case"in-progress":return"bg-blue-50 border-blue-200 text-blue-800";case"cancelled":return"bg-red-50 border-red-200 text-red-800";default:return"bg-white border-gray-200 text-gray-900 hover:bg-gray-50"}};function ke({providerId:i,selectedDate:t,appointments:a,onPatientClick:n,onAddAppointment:o,isLoading:m=!1}){const g=we(),p=a.reduce((c,r)=>(c[r.time]=r,c),{}),x=()=>{const c=new Date,r=t.toDateString()===c.toDateString(),f=new Date(c);f.setDate(f.getDate()+1);const b=t.toDateString()===f.toDateString(),y=new Date(c);y.setDate(y.getDate()-1);const S=t.toDateString()===y.toDateString();return r?"Today":b?"Tomorrow":S?"Yesterday":t.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})};return m?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded mb-4 w-1/3"}),[...Array(10)].map((c,r)=>e.jsxs("div",{className:"flex items-center p-3 mb-2 border rounded",children:[e.jsx("div",{className:"w-16 h-4 bg-gray-200 rounded mr-4"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2 w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]})]},r))]})}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-white",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Daily Schedule - ",x()]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Y,{className:"w-3 h-3 text-gray-400 mr-1"}),"Scheduled (",a.filter(c=>c.status==="scheduled").length,")"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(F,{className:"w-3 h-3 text-blue-500 mr-1"}),"In Progress (",a.filter(c=>c.status==="in-progress").length,")"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(W,{className:"w-3 h-3 text-green-500 mr-1"}),"Completed (",a.filter(c=>c.status==="completed").length,")"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"p-4 space-y-1",children:g.map(c=>{const r=p[c];return r?e.jsxs("div",{className:`p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${Ae(r.status)}`,onClick:()=>n(r),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium text-sm",children:c})]}),Se(r.status)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:f=>{f.stopPropagation(),n(r)},className:"p-1 rounded hover:bg-white/50 transition-colors",title:"Start Dictation",children:e.jsx(z,{className:"w-4 h-4"})}),r.patientPhone&&e.jsx(ie,{className:"w-4 h-4 text-gray-400"})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-semibold",children:r.patientName}),r.visitType&&e.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-600",children:r.visitType.replace("-"," ")})]}),r.visitReason&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 ml-6",children:r.visitReason}),r.patientPhone&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1 ml-6",children:["ðŸ“ž ",r.patientPhone]})]})]},c):e.jsxs("div",{className:"p-3 border border-dashed border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors group",onClick:()=>o(c),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-500",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:c})]}),e.jsx(I,{className:"w-4 h-4 text-gray-400 group-hover:text-gray-600"})]}),e.jsx("span",{className:"text-xs text-gray-400 ml-6 group-hover:text-gray-500",children:"Click to add appointment"})]},c)})})})]})}function ze(){const{user:i,logout:t}=R(),a=$(),n=O.getCurrentUser(),o=n?.id||n?.email||"doctor-default-001",[m,g]=u.useState(new Date),[p,x]=u.useState("day"),[c,r]=u.useState("calendar"),[f,b]=u.useState(!1),[y,S]=u.useState(""),[v,d]=u.useState(null),[s,l]=u.useState({patientName:"",patientPhone:"",patientEmail:"",appointmentTime:"",visitType:"follow-up",visitReason:"",notes:""}),{appointments:j,isLoading:N,error:A,refreshSchedule:B,createAppointment:K,updateAppointment:J,updateAppointmentStatus:G}=Ne({providerId:o,date:m,autoRefresh:!0,refreshInterval:3e4});E("DoctorDashboardUnified","Info message",{});const q=async()=>{if(!s.appointmentTime||!s.patientName.trim()){alert("Please enter patient name and select a time");return}try{v?await J(v.id,{patientName:s.patientName,patientPhone:s.patientPhone,patientEmail:s.patientEmail,time:s.appointmentTime,visitType:s.visitType,visitReason:s.visitReason,notes:s.notes}):await K({patientName:s.patientName,patientPhone:s.patientPhone,patientEmail:s.patientEmail,time:s.appointmentTime,visitType:s.visitType,visitReason:s.visitReason,notes:s.notes}),l({patientName:"",patientPhone:"",patientEmail:"",appointmentTime:"",visitType:"follow-up",visitReason:"",notes:""}),b(!1),d(null)}catch{w("DoctorDashboardUnified","Error message",{}),alert("Failed to save appointment. Please try again.")}},H=h=>{G(h.id,"in-progress"),sessionStorage.setItem("current_patient",JSON.stringify({id:h.patientId,name:h.patientName,appointmentId:h.id,date:m.toISOString().split("T")[0],time:h.time})),a("/quick-note")},Q=h=>{S(h),l({patientName:"",patientPhone:"",patientEmail:"",appointmentTime:h,visitType:"follow-up",visitReason:"",notes:""}),b(!0)},Z=h=>{r(h)},V=()=>c==="templates"?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Templates"}),e.jsx("p",{className:"text-gray-600",children:"Template management coming soon..."})]}):c==="notes"?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Notes"}),e.jsx("p",{className:"text-gray-600",children:"Note management coming soon..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{selectedDate:m,onDateChange:g,onViewChange:x,currentView:p}),e.jsx(ke,{providerId:o,selectedDate:m,appointments:j,onPatientClick:H,onAddAppointment:Q})]});return N?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Loading schedule..."}),e.jsx("div",{className:"text-gray-500",children:"Connecting to database"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ve,{currentView:c,onViewChange:Z,practiceInfo:{name:"TSHLA Medical"},showNotifications:!0}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[A&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[e.jsx("div",{className:"text-red-800 font-medium",children:"Database Error"}),e.jsx("div",{className:"text-red-600 text-sm mt-1",children:A}),e.jsx("button",{onClick:B,className:"mt-2 px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Retry Connection"})]}),V()]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:v?"Edit Appointment":"Add New Patient"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Patient Name *"}),e.jsx("input",{type:"text",value:s.patientName,onChange:h=>l({...s,patientName:h.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter patient name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:s.patientPhone,onChange:h=>l({...s,patientPhone:h.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx("input",{type:"email",value:s.patientEmail,onChange:h=>l({...s,patientEmail:h.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Time *"}),e.jsx("input",{type:"time",value:s.appointmentTime,onChange:h=>l({...s,appointmentTime:h.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Visit Type"}),e.jsxs("select",{value:s.visitType,onChange:h=>l({...s,visitType:h.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"new-patient",children:"New Patient"}),e.jsx("option",{value:"follow-up",children:"Follow-up"}),e.jsx("option",{value:"urgent",children:"Urgent"}),e.jsx("option",{value:"procedure",children:"Procedure"}),e.jsx("option",{value:"lab-review",children:"Lab Review"}),e.jsx("option",{value:"telemedicine",children:"Telemedicine"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Visit Reason"}),e.jsx("input",{type:"text",value:s.visitReason,onChange:h=>l({...s,visitReason:h.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Reason for visit"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{value:s.notes,onChange:h=>l({...s,notes:h.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Additional notes"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:q,disabled:N,className:"flex-1 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Saving...":v?"Update":"Save"}),e.jsx("button",{onClick:()=>{b(!1),d(null)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})})]})}export{ze as default};
//# sourceMappingURL=DoctorDashboardUnified-XoznMR0r.js.map
