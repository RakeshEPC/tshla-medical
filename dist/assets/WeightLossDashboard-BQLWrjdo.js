import{u as C,r as h,j as e}from"./index-JAW6HvUl.js";import{w as g}from"./weightLossProfile.service-BCodgXN-.js";function T(){const m=C(),[t,u]=h.useState(null),[i,f]=h.useState([]),[x,y]=h.useState({totalWeightLoss:0,percentageLoss:0,averageWeeklyLoss:0,currentStreak:0,daysOnProgram:0}),[b,N]=h.useState({isStalled:!1,daysStalled:0}),[w,v]=h.useState(!0),[S,W]=h.useState(!1);h.useEffect(()=>{D()},[]);const D=()=>{const s=`patient_${Date.now()}`,r=g.loadProfile(s);if(!r){m("/weightloss/onboarding");return}u(r);const l=new Date().toISOString().split("T")[0],d=new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],a=g.getDailyCheckins(r.patientId,d,l);f(a);const n=g.calculateProgress(r.patientId);y(n);const c=g.detectStall(r.patientId);N(c),W(g.isTodayCheckinComplete(r.patientId)),v(!1)},L=()=>{if(i.length<2)return"stable";const s=i.filter(n=>n.weight).map(n=>n.weight);if(s.length<2)return"stable";const r=s.slice(-7),l=s.slice(-14,-7);if(l.length===0)return"stable";const d=r.reduce((n,c)=>n+c,0)/r.length,a=l.reduce((n,c)=>n+c,0)/l.length;return d<a-.5?"down":d>a+.5?"up":"stable"},o=s=>t?t.demographics.preferredUnits.weight==="kg"?s.toFixed(1):Math.round(s*2.20462).toString():s.toString();if(w)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Loading dashboard..."})]})});if(!t)return null;const j=L();return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-white to-blue-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Your Progress Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Day ",x.daysOnProgram," of your journey"]})]}),e.jsxs("div",{className:"flex space-x-3",children:[!S&&e.jsx("button",{onClick:()=>m("/weightloss/checkin"),className:"px-6 py-3 bg-gradient-to-r from-green-600 to-blue-600 text-white font-semibold rounded-lg hover:from-green-700 hover:to-blue-700 shadow-lg",children:"Today's Check-in"}),e.jsx("button",{onClick:()=>m("/weightloss/onboarding"),className:"px-6 py-3 bg-white text-gray-700 font-semibold rounded-lg border-2 border-gray-300 hover:bg-gray-50",children:"Edit Profile"})]})]})}),b.isStalled&&e.jsx("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-3xl",children:"ğŸ¤”"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-yellow-800",children:"Weight Loss Plateau Detected"}),e.jsxs("div",{className:"text-sm text-yellow-700",children:["Your weight has been stable for ",b.daysStalled," days. Consider trying a protein reset or increasing activity."]})]})]})}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Total Loss"}),e.jsx("span",{className:`text-2xl ${j==="down"?"ğŸ“‰":j==="up"?"ğŸ“ˆ":"â¡ï¸"}`})]}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[o(Math.abs(x.totalWeightLoss))," ",t.demographics.preferredUnits.weight]}),e.jsxs("div",{className:`text-sm mt-1 ${x.totalWeightLoss>0?"text-green-600":"text-gray-600"}`,children:[x.percentageLoss.toFixed(1),"% of body weight"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Weekly Average"}),e.jsx("span",{className:"text-2xl",children:"ğŸ“Š"})]}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[o(Math.abs(x.averageWeeklyLoss))," ",t.demographics.preferredUnits.weight]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"per week"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Check-in Streak"}),e.jsx("span",{className:"text-2xl",children:"ğŸ”¥"})]}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:x.currentStreak}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"days"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Current Weight"}),e.jsx("span",{className:"text-2xl",children:"âš–ï¸"})]}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[i.length>0&&i[i.length-1].weight?o(i[i.length-1].weight):o(t.demographics.startingWeight)," ",t.demographics.preferredUnits.weight]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Goal: ",o(t.demographics.targetWeight||0)," ",t.demographics.preferredUnits.weight]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Weight Trend (Last 30 Days)"}),e.jsx("div",{className:"h-48 flex items-end space-x-1",children:i.slice(-30).map((s,r)=>{const l=s.weight||t.demographics.startingWeight,d=Math.max(...i.map(p=>p.weight||t.demographics.startingWeight)),a=Math.min(...i.map(p=>p.weight||t.demographics.startingWeight)),n=d-a||1,c=(l-a)/n*100;return e.jsx("div",{className:"flex-1 bg-gradient-to-t from-blue-500 to-blue-400 rounded-t hover:from-blue-600 hover:to-blue-500 transition-all",style:{height:`${c}%`,minHeight:"4px"},title:`${s.date}: ${o(l)} ${t.demographics.preferredUnits.weight}`},r)})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsx("span",{children:"30 days ago"}),e.jsx("span",{children:"Today"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Daily Goals (Last 7 Days)"}),e.jsx("div",{className:"space-y-3",children:["Protein","Steps","Sleep","Water"].map(s=>{const r=i.slice(-7);let l=0;r.forEach(a=>{s==="Protein"&&a.protein&&a.protein>=t.targets.protein.target*.9&&l++,s==="Steps"&&a.steps&&a.steps>=t.targets.steps.minimum&&l++,s==="Sleep"&&a.sleep&&a.sleep>=t.targets.sleep.minimumHours&&l++,s==="Water"&&a.hydration&&a.hydration>=t.targets.hydration.target*.9&&l++});const d=r.length>0?l/r.length*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-700",children:s}),e.jsxs("span",{className:"text-gray-500",children:[l,"/7 days"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${d>=80?"bg-green-500":d>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${d}%`}})})]},s)})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Recent Check-ins"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm text-gray-500 border-b",children:[e.jsx("th",{className:"pb-2",children:"Date"}),e.jsx("th",{className:"pb-2",children:"Weight"}),e.jsx("th",{className:"pb-2",children:"Steps"}),e.jsx("th",{className:"pb-2",children:"Protein"}),e.jsx("th",{className:"pb-2",children:"Mood"}),e.jsx("th",{className:"pb-2",children:"Symptoms"})]})}),e.jsx("tbody",{children:i.slice(-7).reverse().map(s=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 text-gray-900",children:new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx("td",{className:"py-3",children:s.weight?`${o(s.weight)} ${t.demographics.preferredUnits.weight}`:"--"}),e.jsx("td",{className:"py-3",children:s.steps?.toLocaleString()||"--"}),e.jsx("td",{className:"py-3",children:s.protein?`${s.protein}g`:"--"}),e.jsxs("td",{className:"py-3",children:[s.mood==="great"&&"ğŸ˜„",s.mood==="good"&&"ğŸ™‚",s.mood==="okay"&&"ğŸ˜",s.mood==="low"&&"ğŸ˜•",s.mood==="terrible"&&"ğŸ˜”"]}),e.jsxs("td",{className:"py-3",children:[s.nausea>5&&"ğŸ¤¢",s.constipation>5&&"ğŸš½",s.nausea<=5&&s.constipation<=5&&"âœ“"]})]},s.date))})]})})]})]})})}export{T as default};
//# sourceMappingURL=WeightLossDashboard-BQLWrjdo.js.map
