{"version":3,"file":"EarlyAccessAdmin-wGjyLt4E.js","sources":["../../src/pages/EarlyAccessAdmin.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { logError, logWarn, logInfo, logDebug } from '../services/logger.service';\n\ninterface Application {\n  name: string;\n  email: string;\n  title: string;\n  specialty: string;\n  applications: string;\n  whyInterested: string;\n  submittedAt: string;\n  source: string;\n}\n\nconst EarlyAccessAdmin: React.FC = () => {\n  const [applications, setApplications] = useState<Application[]>([]);\n  const [showDetails, setShowDetails] = useState<number | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [dataSource, setDataSource] = useState<'backend' | 'localStorage' | 'both'>('both');\n\n  useEffect(() => {\n    loadApplications();\n  }, []);\n\n  const loadApplications = async () => {\n    setLoading(true);\n    const allApplications: Application[] = [];\n\n    // Try to load from backend API\n    const apiUrl = import.meta.env.VITE_API_URL || 'https://api.tshla.ai';\n    try {\n      // Check if user has auth token (from doctor login)\n      const authToken = localStorage.getItem('authToken');\n\n      if (authToken) {\n        const response = await fetch(`${apiUrl}/api/early-access`, {\n          headers: {\n            Authorization: `Bearer ${authToken}`,\n          },\n        });\n\n        if (response.ok) {\n          const backendApps = await response.json();\n          allApplications.push(...backendApps);\n          setDataSource('backend');\n        }\n      }\n    } catch (err) {\n      logDebug('EarlyAccessAdmin', 'Debug message', {});\n    }\n\n    // Also load from localStorage\n    const storedApplications = JSON.parse(localStorage.getItem('earlyAccessApplications') || '[]');\n\n    // Merge and deduplicate based on email\n    const merged = [...allApplications, ...storedApplications];\n    const unique = merged.filter(\n      (app, index, self) => index === self.findIndex(a => a.email === app.email)\n    );\n\n    setApplications(unique);\n    if (unique.length > allApplications.length && allApplications.length > 0) {\n      setDataSource('both');\n    } else if (allApplications.length === 0) {\n      setDataSource('localStorage');\n    }\n\n    setLoading(false);\n  };\n\n  const exportToCSV = () => {\n    const headers = [\n      'Name',\n      'Email',\n      'Title',\n      'Specialty',\n      'Applications',\n      'Why Interested',\n      'Submitted At',\n      'Source',\n    ];\n    const rows = applications.map(app => [\n      app.name,\n      app.email,\n      app.title,\n      app.specialty,\n      app.applications,\n      app.whyInterested.replace(/,/g, ';'), // Replace commas to avoid CSV issues\n      app.submittedAt,\n      app.source,\n    ]);\n\n    const csvContent = [\n      headers.join(','),\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(',')),\n    ].join('\\n');\n\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `early-access-applications-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n  };\n\n  const clearApplications = () => {\n    if (window.confirm('Are you sure you want to clear all applications? This cannot be undone.')) {\n      localStorage.removeItem('earlyAccessApplications');\n      setApplications([]);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Early Access Applications</h1>\n            {!loading && applications.length > 0 && (\n              <p className=\"text-sm text-gray-500 mt-1\">\n                Data source:{' '}\n                {dataSource === 'backend'\n                  ? 'üåê Backend Database'\n                  : dataSource === 'localStorage'\n                    ? 'üíæ Local Storage'\n                    : 'üîÑ Backend + Local Storage'}\n                ({applications.length} applications)\n              </p>\n            )}\n          </div>\n          <div className=\"space-x-4\">\n            <button\n              onClick={exportToCSV}\n              className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\n              disabled={applications.length === 0}\n            >\n              Export to CSV\n            </button>\n            <button\n              onClick={clearApplications}\n              className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700\"\n              disabled={applications.length === 0}\n            >\n              Clear All\n            </button>\n          </div>\n        </div>\n\n        {loading ? (\n          <div className=\"bg-white rounded-lg shadow p-8 text-center\">\n            <p className=\"text-gray-500\">Loading applications...</p>\n          </div>\n        ) : applications.length === 0 ? (\n          <div className=\"bg-white rounded-lg shadow p-8 text-center\">\n            <p className=\"text-gray-500\">\n              No applications yet. Share your landing page to start collecting submissions!\n            </p>\n            <p className=\"text-sm text-gray-400 mt-2\">\n              Applications will appear here when submitted through the form.\n            </p>\n          </div>\n        ) : (\n          <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n            <table className=\"min-w-full\">\n              <thead className=\"bg-gray-100\">\n                <tr>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Name\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Email\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Title\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Applications\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Submitted\n                  </th>\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {applications.map((app, index) => (\n                  <React.Fragment key={index}>\n                    <tr className=\"hover:bg-gray-50\">\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                        {app.name}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {app.email}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {app.title}\n                      </td>\n                      <td className=\"px-6 py-4 text-sm text-gray-500\">\n                        <div className=\"max-w-xs truncate\">{app.applications}</div>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {new Date(app.submittedAt).toLocaleDateString()}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                        <button\n                          onClick={() => setShowDetails(showDetails === index ? null : index)}\n                          className=\"text-blue-600 hover:text-blue-800\"\n                        >\n                          {showDetails === index ? 'Hide' : 'View'} Details\n                        </button>\n                      </td>\n                    </tr>\n                    {showDetails === index && (\n                      <tr>\n                        <td colSpan={6} className=\"px-6 py-4 bg-gray-50\">\n                          <div className=\"space-y-3\">\n                            <div>\n                              <span className=\"font-semibold text-gray-700\">Specialty:</span>{' '}\n                              <span className=\"text-gray-600\">\n                                {app.specialty || 'Not specified'}\n                              </span>\n                            </div>\n                            <div>\n                              <span className=\"font-semibold text-gray-700\">\n                                Applications Interested In:\n                              </span>{' '}\n                              <span className=\"text-gray-600\">{app.applications}</span>\n                            </div>\n                            <div>\n                              <span className=\"font-semibold text-gray-700\">Why Interested:</span>\n                              <p className=\"text-gray-600 mt-1\">{app.whyInterested}</p>\n                            </div>\n                            <div>\n                              <span className=\"font-semibold text-gray-700\">Source:</span>{' '}\n                              <span className=\"text-gray-600\">{app.source}</span>\n                            </div>\n                            <div>\n                              <span className=\"font-semibold text-gray-700\">Submitted At:</span>{' '}\n                              <span className=\"text-gray-600\">\n                                {new Date(app.submittedAt).toLocaleString()}\n                              </span>\n                            </div>\n                          </div>\n                        </td>\n                      </tr>\n                    )}\n                  </React.Fragment>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n\n        <div className=\"mt-8 p-4 bg-blue-50 rounded-lg\">\n          <h2 className=\"text-sm font-semibold text-blue-900 mb-2\">üìù Admin Access:</h2>\n          <p className=\"text-sm text-blue-700\">\n            {dataSource === 'backend'\n              ? 'Applications are being fetched from the backend database. You are logged in as an admin.'\n              : dataSource === 'both'\n                ? 'Showing combined data from backend database and local browser storage.'\n                : 'Applications shown from browser localStorage. Log in as a doctor to access backend database.'}\n          </p>\n          <p className=\"text-sm text-blue-600 mt-2\">\n            Access this admin page at{' '}\n            <code className=\"bg-blue-100 px-1 rounded\">/early-access-admin</code>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EarlyAccessAdmin;\n"],"names":["EarlyAccessAdmin","applications","setApplications","useState","showDetails","setShowDetails","loading","setLoading","dataSource","setDataSource","useEffect","loadApplications","allApplications","apiUrl","authToken","response","backendApps","logDebug","storedApplications","unique","app","index","self","a","exportToCSV","headers","rows","csvContent","row","cell","blob","url","clearApplications","jsxs","jsx","React"],"mappings":"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"}